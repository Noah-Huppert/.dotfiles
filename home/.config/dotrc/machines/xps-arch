# Restart wifi
function wifi() {
	sudo netctl restart wlp58s0-dragonfly3
}

# Control backlight, $1 should be the desired backlight percent
function b() {
	[ -z "$1" ] && echo "Expected 1 argument" && return

	local brightness=$(awk -v mod="$1" -v max="$(cat /sys/class/backlight/intel_backlight/max_brightness)" 'BEGIN{printf "%.0f", (mod/100)*max}')

	sudo tee /sys/class/backlight/intel_backlight/brightness <<< $brightness
}

# Restart polybar
function polystart() {
	# Run polybar launch script with nohup, redirect output to null
	echo "Restarting Polybar"
	$(cd ~ && nohup $HOME/.config/polybar/launch.sh > /dev/null) &
}

# Monitor variables: Hold xrandr output identifiers to use in xtend-{on,off} 
# commands
# Identifier for laptop screen
export XRDR_LAPTOP="eDP-1"

# Identifier for HDMI USB-C dongle output
export XRDR_HDMI_DONGLE="DP-1"

# Setup second monitor
function xtend-on() {
	echo "Setting up extended display"

	# Set xrandr to extend HDMI dongle above monitor
	echo "-- -- Configuring xrandr"

	xrandr --output "$XRDR_HDMI_DONGLE" --auto
	xrandr --output "$XRDR_LAPTOP" --below "$XRDR_HDMI_DONGLE"

	# Restart polybar so it displays on both screens
	echo "-- -- Restarting polybar"
	polystart

	# Map bspwm desktops: [0-5]: laptop, [6-10]: hdmi dongle
	echo "-- -- Configuring bspwm desktops"
	bspc monitor eDP-1 -n 0 -d I II III IV V
	bspc monitor DP-1 -n 1 -d VI VII VIII IX X
}

function xtend-off() {
	echo "Shutting down extended display"

	# Use xrandr to turn off DP-1 output
	echo "-- -- Turning off display with xrandr"
	xrandr --output "$XRDR_HDMI_DONGLE" --off

	# Restart polybar to only be on one display
	polystart
}

# APK Tool
export PATH="$PATH:$HOME/Documents/bin/apktool"

# Stockfish
export PATH="$PATH:$HOME/Documents/bin/stockfish"

# Python local bin
export PATH="$PATH:$HOME/.local/bin"

# Google Cloud Bin
export PATH="$PATH:/opt/google-cloud-sdk/bin"
